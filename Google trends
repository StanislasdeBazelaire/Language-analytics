install.packages("reshape2")
install.packages("ggplot2")
install.packages("gtrendsR")
install.packages("writexl")
library(gtrendsR)
library(ggplot2)
library(reshape2)
library(writexl)

#define the keywords
keywords=c("Renault","Peugeot")
#set the geographic area: FR = France
country=c("FR")
#set the time window
time=("2015-01-01 2020-06-26")
#set channels 
channel="web"
#Export destination
dest<-"C:/Users/Stanislas/Datascience/NLP/export.xlsx" 


#Run the query
trends=gtrends(keyword=keywords,geo=country,time=time,gprop =channel)
#select only interst over time 
time_trend=trends$interest_over_time
#Define the plot
plot<-ggplot(data=time_trend, aes(x=date, y=hits,group=keyword,col=keyword))+
  geom_line()+xlab('Time')+ylab('Relative Interest')+ theme_bw()+
  theme(legend.title = element_blank(),legend.position="bottom",legend.text=element_text(size=12))+ggtitle("Google Search Volume")
#Show it
plot

#Export to Excel
write_xlsx(time_trend,dest)
